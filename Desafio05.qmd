---
title: "Desafio_05"
format: html
---

```{r}
#install.packages("RSQLite")
library(RSQLite)
```

```{r}
db <- dbConnect(SQLite(), '../Desafio05/disco.db')
db
```

```{r}
dbListTables(db)
```

```{r}
dbListFields(db,'albums')
```

```{r}
album_db = dbGetQuery(db,'SELECT * FROM albums')
head(album_db)
```

```{r}
dim(album_db)
```

```{r}
sql = 'SELECT trackid, name, composer, unitprice FROM tracks ORDER BY unitprice'
res = dbGetQuery(db, sql)
head(res)
```

```{r}
sql2 = 'SELECT city FROM customers ORDER BY city'
ex3a = dbGetQuery(db, sql2)
head(ex3a)
```

```{r}
dim(ex3a)
```

```{r}
sql3 = 'SELECT DISTINCT city FROM customers ORDER BY city'
ex3b = dbGetQuery(db, sql3)
head(ex3b)
```

```{r}
dim(ex3b)
```

```{r}
db_alb_1 <- dbGetQuery(db,'SELECT name, albumid FROM tracks WHERE albumid=1')
```

```{r}
sql4 = paste('SELECT name, albumid, mediatypeid FROM tracks',
             'WHERE mediatypeid IN (1, 2)','ORDER BY name LIMIT 5')
dbGetQuery(db, sql4)
```

```{r}
sql5 = paste('SELECT trackid, name, albumid FROM tracks'
,
'WHERE albumid IN'
,
'(SELECT albumid FROM albums WHERE artistid==12)')
dbGetQuery(db, sql5)
```

```{r}
sql6 = "SELECT trackid, name FROM tracks WHERE name GLOB '?ere*'"
dbGetQuery(db, sql6)
```

```{r}
sql7 = "SELECT trackid, name FROM tracks WHERE name GLOB '*[0-9]*'"
dbGetQuery(db, sql7)
```

```{r}
sql8 = 'SELECT albumid, COUNT(trackid) FROM tracks GROUP BY albumid'
dbGetQuery(db, sql8)
```

```{r}
sql9 = paste('SELECT albumid, COUNT(trackid)'
,
'FROM tracks GROUP BY albumid'
,
'HAVING albumid=1')
dbGetQuery(db, sql9)
```

```{r}
sql10 = paste('SELECT trackid, name, title FROM tracks'
,
'INNER JOIN albums ON albums.albumid=tracks.albumid')
dbGetQuery(db, sql10)
```
